// Generated by Knoux-Integrator AI — 2026-01-26
// Clipboard IPC Wrapper (JS fallback for TS errors)

const { ipcMain } = require('electron');

// Mock clipboard service (replace with actual when TS compiles)
const clipboardService = {
  async getRecentItems() {
    return [
      { id: 1, content: 'Sample clipboard item 1', timestamp: Date.now() },
      { id: 2, content: 'Sample clipboard item 2', timestamp: Date.now() - 1000 }
    ];
  },
  async pushItem(item) {
    console.log('Clipboard item pushed:', item);
    return { success: true };
  },
  async getHistory() {
    return this.getRecentItems();
  },
  async normalize(content) {
    return { normalized: content.trim(), changes: [] };
  },
  async format(content, format) {
    return { formatted: content, format };
  }
};

function registerClipboardIPC() {
  ipcMain.handle('knoux.clipboard.read', async () => {
    try {
      const items = await clipboardService.getRecentItems();
      return { ok: true, data: items };
    } catch (err) {
      return { ok: false, error: String(err) };
    }
  });

  ipcMain.handle('knoux.clipboard.write', async (evt, item) => {
    try {
      await clipboardService.pushItem(item);
      return { ok: true };
    } catch (err) {
      return { ok: false, error: String(err) };
    }
  });

  ipcMain.handle('knoux.clipboard.history', async () => {
    try {
      const history = await clipboardService.getHistory();
      return { ok: true, data: history };
    } catch (err) {
      return { ok: false, error: String(err) };
    }
  });

  ipcMain.handle('knoux.clipboard.normalize', async (evt, content) => {
    try {
      const result = await clipboardService.normalize(content);
      return { ok: true, data: result };
    } catch (err) {
      return { ok: false, error: String(err) };
    }
  });

  ipcMain.handle('knoux.clipboard.format', async (evt, content, format) => {
    try {
      const result = await clipboardService.format(content, format);
      return { ok: true, data: result };
    } catch (err) {
      return { ok: false, error: String(err) };
    }
  });

  console.log('✅ Clipboard IPC handlers registered');
}

module.exports = { registerClipboardIPC };
